DB.sum=DB.reduceLeft(function(a,b,c){return a+b[c]}),DB.max=DB.reduceLeft(Number.MIN_VALUE,function(a,b,c){return b[c]>a?b[c]:a}),DB.min=DB.reduceLeft(Number.MAX_VALUE,function(a,b,c){return b[c]<a?b[c]:a}),DB.tabular=function(a,b,c,d,e){e=e||DB.sum;var f=a.distinct(b),g=a.distinct(c),h=[[b].concat(g)];return h.concat(DB.map(f,function(f){var h=a.find(b,f);return[f].concat(DB.map(g,function(a){return e(h.find(c,a),d)||0}))}))};