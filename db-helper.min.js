DB.sum=DB.reduceLeft(function(a,b,c){return a+b[c]}),DB.max=DB.reduceLeft(Number.MIN_VALUE,function(a,b,c){return b[c]>a?b[c]:a}),DB.min=DB.reduceLeft(Number.MAX_VALUE,function(a,b,c){return b[c]<a?b[c]:a}),DB.tabular=function(a,b){agg=agg||DB.sum;var c,d=b.order,e=b.row_key,f=b.col_key,g=b.cell_key,h=b.row_order||a.distinct(e),i=b.col_order||a.distinct(f),j={},k=[b.header||[b.name||e].concat(i)];if(DB.isString(g)?DB.each(i,function(a){j[a]=g}):j=g,c=DB.map(h,function(b){var c=a.find(e,b);return[b].concat(DB.map(i,function(a){return agg(c.find(f,a),j[a])||0}))}),DB.isString(d)){var l=i.indexOf(d)+1;d=function(a,b){return b[l]-a[l]}}return DB.isFunction(d)&&(c=c.sort(d)),k.concat(c)};